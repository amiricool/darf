<target name="fix-reviews" description="Déplacer un répertoire dans le ZIP">
  <property name="archive.reviews" value="${project.build.directory}/reviews.zip"/>
  <property name="plugin.version"  value="${code.review.plugin.version}"/>

  <!-- Crée une copie du ZIP avec le dossier renommé -->
  <zip destfile="${archive.reviews}.tmp" whenempty="fail">
    <!-- Exclut l’ancien dossier -->
    <zipfileset src="${archive.reviews}"
                excludes="code-review-resources-${plugin.version}/**"/>

    <!-- Réinjecte le contenu en le mappant vers le nouveau chemin -->
    <zipfileset src="${archive.reviews}">
      <include name="code-review-resources-${plugin.version}/**"/>
      <mapper>
        <globmapper
          from="code-review-resources-${plugin.version}/*"
          to="resources/*"/>
      </mapper>
    </zipfileset>
  </zip>

  <!-- Remplace le ZIP original -->
  <move file="${archive.reviews}.tmp" tofile="${archive.reviews}" overwrite="true"/>
</target>